I think all conversions to in-place ops should go at the end
